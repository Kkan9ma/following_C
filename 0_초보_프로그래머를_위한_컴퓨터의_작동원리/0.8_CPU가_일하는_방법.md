# 0.8 CPU가 일하는 방법
<img src="https://github.com/uber9ma/following_C/blob/master/images/chapter0/comp16.png?raw=true" width="1000">

* 모든 정보는 메모리에 있다. 다만 그를 찾기 위해 메모리를 다 살피는 것이 아니라, 
주소를 살핀 후 그 공간의 데이터를 가져온다.

<img src="https://github.com/uber9ma/following_C/blob/master/images/chapter0/comp17.png?raw=true">

* 프로그램이 실행되기 위해 주소에 load, add, store 된다.

<img src="https://github.com/uber9ma/following_C/blob/master/images/chapter0/comp18.png?raw=true">

* 10번지에 A라는 이름을 붙이고, 그 공간에 3을 붙인다. B는 마찬가지. 

* CPU가 하는 일: 10번지에 있는 data를 cpu로 가져오고, 11번지에 있는 숫자를 가져오고, 더하고, 
더한 값을 12에 넣는다.

<img src="https://github.com/uber9ma/following_C/blob/master/images/chapter0/comp19.png?raw=true">

* 단계
1. __프로그램 카운터(Program Counter: PC)__ 라는 레지스터에 프로그램의 첫 번째 __instruction (명령어)__ 이 어느 주소에 들어 있는지 넣는다.
    - __operation system__ 이 프로그램을 읽어온 후, `여기서부터 프로그램이니 실행시키라` CPU에게 알려주는 것.
    - __PC__ 는 다음 실행해야 할 명령어의 주소도 가리키게 되어 있음.
    - 즉, `여기서부터 시작하라`는 __시작점__ 을 던져 준 것.
2. __프로그램 카운터__ 에 있던 주소가 __메모리 주소 레지스터__ 로 간다. 
3. __메모리 주소 레지스터__ 에 있던 주소에 접근하여(LOAD 10), __메모리 데이터 레지스터__ 로 이동함. 제어장치가 제어함,
4. PC에 의해 가져온, __메모리 데이터 레지스터__ 가 읽어온 것은 __instruction__ 이기에, __명령어 레지스터__ 로 이동(LOAD 10)
5. `'주의'` __프로그램 카운터 증가 (100 -> 101)__ , 증가 이유: 다음 읽어와야 하는 메모리 주소를 갖고 있어야 하기 때문.
6. __명령어 레지스터__ 에 있는 __instruction__ 이 __제어 장치__ 에 들어간다. (decode)
7. `10번지에 있는 데이터를 LOAD해라` 해독. => __메모리주소 레지스터__ 에 `10`을 넣는다.
8. `10번지`에 있는 데이터를 __메모리 데이터 레지스터__ 로 갖고 온다.
9. 아까는 __메모리 데이터 레지스터__ 에 있는 것이 __명령어__ 였기에, __명령어 레지스터__ 로 향했지만, 지금은 데이터기에 __어큐뮬레이터(이 역시 하나의 래지스터)__ 로 향함 
10. `LOAD 10`이라는 __instruction__  끝남. => 다음 줄 실행해야 함. => 프로그램 카운터에 있는 주소를 가져옴 
11. __다음 줄(101)에 있는 명렁어__ 를 갖고 옴. (__메모리 데이터 레지스터__) 
12. __프로그램 키운터__ 로 향함.
13. __명령어 레지스터__: 해독함. (`ADD 11`): `11번지 주소에 있는 데이터를 더해라`
14. `ADD`를 하기 위해, 즉, `미리 읽어둔 숫자에 11을 더하기` 위해, __어큐뮬레이터__ 에 3을 옮김.
15. `11`을 __메모리 주소__ 로 옮김
16. `11 메모리 주소`로부터 데이터(4)를 갖고 옴.
17. __어큐뮬레이터__ 로 향함. // 어큐뮬레이터: 산술작업에 쓰일 데이터가 저장되는 레지스터
18. __산술 논리 장치__ 에서 연산 => `3 + 4 = 7`
19. 계산 결과가 __어큐뮬레이터__ 에 저장됨.
20. __프로그램 카운터__ 가 다음 __instruction을 실행하기__  위해 __프로그램 카운터__의 주소가 __메모리 주소 레지스터__ 로 들어감
21. 102번지의 데이터(`STORE 12`)가 __메모리 데이터 레지스터__ 로 들어오고,
22. 명령어이기 때문에 __명령어 레지스터__ 로 들어간다
23. __프로그램 카운터__ 증가
24. (그 이후엔 내용이 없기에 프로그램은 종료 예정)
25. 명령어(`STORE 12`: __제어 장치__ 로 들어감
26. 12번지에 계산 결과를 저장하라는 것을 알게 됨
27. __어큐뮬레이터__ 에 들어 있는 계산 결과가 __메모리 데이터 레지스터__ 로 가며, 
메모리부터 CPU가 데이터를 가져오는 것이 아니라, 계산결과를 메모리로 보내 저장하려는 것.
(`STORE`이기 때문에 제어장치가 데이터를 12번 주소로 보냄)
28. __메모리__ 에 계산결과 7이 저장됨.


<img src="https://github.com/uber9ma/following_C/blob/master/images/chapter0/comp19.png?raw=true">


* 고수준 프로그래밍 언어로 간단히 사용되는 것이 내부에선 위와 같은 원리로 진행되는 것.
* 이런 내용을 항상, 모두 기억할 필요는 없으나, 꼭! 도움이 될 내용이다.